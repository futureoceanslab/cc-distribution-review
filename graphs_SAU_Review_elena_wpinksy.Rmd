---
title: "graphs SAU-Review"
author: "Elena ojea"
date: "20 April 2017"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Preliminary plots

```{r,include=F, echo=F,  message=FALSE}
setwd("~/OneDrive/CLOCK_TEAM/03_FUTURE OCEANS/FO_BIBLIO/FO_DATA_ANALYSIS/R for Sea Around Us Data catches")
library("dplyr")
library(tidyr)
library(ggplot2)
library(ggrepel)

#open Catchdat from Sea Around Use (from eezalbairatxe)
CatchDat <- read.csv("CatchDat.csv")
#open reviewDat
ReviewDat <- read.csv("~/OneDrive/CLOCK_TEAM/03_FUTURE OCEANS/FO_BIBLIO/FO_DATA_ANALYSIS/R for Sea Around Us Data catches/biblio_database.csv", sep=";")

#select the list of species from the review database
SpReview<-as.character(unique(ReviewDat$b_scientific_name))

ReviewDat$eez_countries[ReviewDat$eez_countries=="USA (Alaska, Arctic)" ] <- "USA (Alaska-Subarctic)"
ReviewDat$eez_countries[ReviewDat$eez_countries== "Spain (mainland, Med and Gulf of Cadiz)"] <- "Spain (mainland Med and Gulf of Cadiz)"
ReviewDat$eez_countries[ReviewDat$eez_countries== "USA (West Coast)"] <- "USA (East Coast)"
ReviewDat$eez_countries[ReviewDat$eez_countries== "Denmark (North Sea), Germany (North Sea), Netherlands, Norway, United Kingdom (UK), Belgium, Sweden (West Coast)"] <- "Denmark (North Sea), Germany (North Sea), Netherlands, Norway, United Kingdom (UK), Belgium"



#adapt names from datacountries$b_scientific_name to SAU

ReviewDat$b_scientific_name[ReviewDat$b_scientific_name=="Seriola quinqueradiata"] <- "Seriola"
ReviewDat$b_scientific_name[ReviewDat$b_scientific_name=="Sebastes viviparus"] <- "Sebastes"
ReviewDat$b_scientific_name[ReviewDat$b_scientific_name=="Enchelyopus cimbrius"] <- "Gaidropsarus"
ReviewDat[43,11] <- "Atheresthes stomias"
ReviewDat$b_scientific_name[ReviewDat$b_scientific_name=="Bathyraja violacea"] <- "Raja"
ReviewDat$b_scientific_name[ReviewDat$b_scientific_name=="Leucoraja erinacea"] <- "Raja"
ReviewDat$b_scientific_name[ReviewDat$b_scientific_name=="Alosa pseudoharengus"] <- "Alosa"
ReviewDat$b_scientific_name[ReviewDat$b_scientific_name=="Alosa sapidissima"] <- "Alosa"
ReviewDat$b_scientific_name[ReviewDat$b_scientific_name=="Pseudopleuronectes americanus"] <- "Pleuronectidae"
ReviewDat$b_scientific_name[ReviewDat$b_scientific_name=="Scophthalmus aquosus"] <- "Scophthalmidae"
ReviewDat$b_scientific_name[ReviewDat$b_scientific_name=="Lophius americanus"] <- "Lophiidae"
ReviewDat$b_scientific_name[ReviewDat$b_scientific_name=="Paralichthys dentatus"] <- "Paralichthyidae"
ReviewDat$b_scientific_name[ReviewDat$b_scientific_name=="Hippoglossina oblonga"] <- "Paralichthyidae"
ReviewDat$b_scientific_name[ReviewDat$b_scientific_name=="Gaidropsarus macrophthalmus"] <- "Gaidropsarus"
ReviewDat[162,11] <- "Lepidopsetta bilineata"
ReviewDat$b_scientific_name[ReviewDat$b_scientific_name=="Atherina presbyter"] <- "Atherina boyeri"
ReviewDat$b_scientific_name[ReviewDat$b_scientific_name=="Myoxocephalus octodecemspinosus"] <- "Cottidae"
ReviewDat$b_scientific_name[ReviewDat$b_scientific_name=="Loligo pealeii"] <- "Loligo"


##join by id_obs
ReviewDat$id_obs <- as.numeric(as.character(ReviewDat$id_obs))

ReviewDatSAU <- left_join(CatchDat, ReviewDat, by="id_obs")


##I prepare the variables for ploting
ReviewDatSAU$b_value <- as.numeric(as.character(ReviewDatSAU$b_value))
ReviewDatSAU$catchdep <- ReviewDatSAU$tonnescatch/ReviewDatSAU$totalcatch #the dependance of the country total catches on the stock catches
ReviewDatSAU$landdep <-  ReviewDatSAU$landedvaluecatch/ReviewDatSAU$totallandings #the dependance of the country total landings on the stock landings


###I create a variable for Species VAlue in country: landed value/tonnes

ReviewDatSAU$spvalue  <- ReviewDatSAU$landedvaluecatch/ReviewDatSAU$tonnescatch

#Subsets of the impacts
ReviewDatSAU$b_impact<-as.factor(ReviewDatSAU$b_impact)
ReviewDatSAU$b_value<-as.numeric(as.character(ReviewDatSAU$b_value))

#levels(ReviewDatSAU$b_impact)
levels(ReviewDatSAU$b_impact)<-c("mean lat shift", "mean lat shift", "depth shift", "boundary lat shift", "mean long shift", "mean lat and long shift", "area occupied")

latitude<-subset (ReviewDatSAU, b_impact =="mean lat shift")
depth<-subset (ReviewDatSAU, b_impact=="depth shift")
range<-subset (ReviewDatSAU, b_impact== "boundary lat shift")
area<-subset (ReviewDatSAU, b_impact == "area occupied")
```

1. Impacts and Countries Catch Dependence

```{r,include=T, echo=F,  message=FALSE}

##1. PLOTS OF IMPACTS AND CATCH DEPENDENCE
  
##latitude impacts

l <- ggplot(latitude, aes(catchdep, b_value, label = fishing_entity)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=catchdep),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(latitude, catchdep>0.10), size=3, vjust=1)+
  ggtitle("Latitude Shift")+
  xlab("country catch dependence (%)")+
  ylab("km/decade")
l 

##depth impacts

d <- ggplot(depth, aes(catchdep, b_value, label = fishing_entity)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=catchdep),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(depth, catchdep>0.15), size=3, vjust=0.5)+
  ggtitle("depth Shift")+
  xlab("country catch dependence (%)")+
  ylab("m/decade?")
d 

##range impacts

r <- ggplot(range, aes(catchdep, b_value, label = fishing_entity)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=catchdep),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(range, catchdep>0.1), size=3, vjust=0.5)+
  ggtitle("Range Shift")+
  xlab("country catch dependence (%)")+
  ylab("km/decade?")
r 

##area impacts

a <- ggplot(area, aes(catchdep, b_value, label = fishing_entity)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=catchdep),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(area, catchdep>0.20), size=3, vjust=0.5)+
  ggtitle("Area Shift")+
  xlab("country catch dependence (%)")+
  ylab("m/decade?")
a 
```
2. Impacts and Countries Landed Value Dependence

```{r,include=T, echo=F,  message=FALSE}

##2. PLOTS OF IMPACTS AND LANDED VALUE DEPENDANCE

##latitude impacts

l2 <- ggplot(latitude, aes(landdep, b_value, label = fishing_entity)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=landdep),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(latitude, landdep>0.2), size=3, vjust=0.5)+
  ggtitle("Latitude Shift")+
  xlab("country landed value dependence (%)")+
  ylab("km/decade")
l2 

##depth impacts

d2 <- ggplot(depth, aes(landdep, b_value, label = fishing_entity)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=landdep),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(depth, landdep>0.25), size=3, vjust=0.5)+
  ggtitle("depth Shift")+
  xlab("country landed value dependence (%)")+
  ylab("m/decade?")
d2 

##range impacts

r2 <- ggplot(range, aes(landdep, b_value, label = fishing_entity)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=landdep),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(range, landdep>0.1), size=3, vjust=0.5)+
  ggtitle("Range Shift")+
  xlab("country landed value dependence (%)")+
  ylab("km/decade?")
r2 

##area impacts

a2 <- ggplot(area, aes(landdep, b_value, label = fishing_entity)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=landdep),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(area, landdep>0.25), size=3, vjust=0.5)+
  ggtitle("Area Shift")+
  xlab("country landed value dependence (%)")+
  ylab("km2/decade?")
a2 
```

3. Impacts and Species Value in Country

```{r,include=T, echo=F,  message=FALSE}

##3. PLOTS OF IMPACTS AND SPECIES VALUE

##latitude impacts

l3 <- ggplot(latitude, aes(spvalue, b_value, label = fishing_entity)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=spvalue),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(latitude, spvalue>12000), size=3, vjust=0.5, position=position_jitter(width=.9, height=2))+
  ggtitle("Latitude Shift")+
  xlab("Species landed value in Country")+
  ylim(-70, 150)+
  ylab("km/decade")
l3 

##depth impacts

d3 <- ggplot(depth, aes(spvalue, b_value, label = fishing_entity)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=spvalue),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(depth, spvalue>13000), size=3, vjust=0.5, position=position_jitter(width=0.8, height=5))+
  ggtitle("depth Shift")+
  xlab("Species landed value in Country")+
  ylab("m/decade")
d3 

##range impacts

r3 <- ggplot(range, aes(spvalue, b_value, label = fishing_entity)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=spvalue),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(range, spvalue>3000), size=2, vjust=0.5, position=position_jitter(width=.2, height=0.5))+
  ggtitle("Range Shift")+
  xlab("Species landed value in Country")+
  ylab("km/decade?")
r3 

##area impacts

a3 <- ggplot(area, aes(spvalue, b_value, label = fishing_entity)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=spvalue),position = position_jitter(width = .01))+
  #geom_text_repel(data=subset(area, spvalue>1000), size=2, vjust=0.5, position=position_jitter(width=.2, height=0.5))+
  ggtitle("Area Shift")+
  xlab("Species landed value in Country")+
  ylab("km2/decade?")
a3 
  
```
4. EEZ total catch

```{r,include=T, echo=F,  message=FALSE}

#open CatchdatEEZ and CatchDatEEZsp from Sea Around Use (from catches SAU area_name and CatchesSAU area name sp)

CatchDatEEZ <- read.csv("CatchDatEEZ.csv")
CatchDatEEZsp <- read.csv("CatchDatEEZsp.csv")


#open reviewDat
#ReviewDat <- read.csv("~/OneDrive/CLOCK_TEAM/03_FUTURE OCEANS/FO_BIBLIO/FO_DATA_ANALYSIS/R for Sea Around Us Data catches/biblio_database.csv", stringsAsFactors=FALSE, header=TRUE)

#I cange the colnames of CatchDatEEZsp to inlcude SP and year

colnames(CatchDatEEZsp) <-  c("X", "id_obs", "scientific_name", "area_name", "year", "tonnescatchSP", "landedvaluecatchSP")
colnames(ReviewDat)[5] <- "year"
colnames(CatchDatEEZ)[3]<- "year"
colnames(CatchDatEEZsp)[3]<- "b_scientific_name"

##Now I join the catch EEZ and EEZsp to review

#1. subset CatchDatEEZsp and CatchDatEEZ to our observations in ReviewDAt

ReviewDatSAU2 <- left_join(ReviewDat, CatchDatEEZ, by=c("id_obs","year"))  ##for EEZs total catch
#ReviewDatSAU3 <- left_join(ReviewDat, CatchDatEEZsp, by=c("id_obs","year")) ##for EEZs total catch on the species

ReviewDatSAU3 <- left_join(ReviewDatSAU2, CatchDatEEZsp, by=c("id_obs","area_name","year"))
ReviewDatSAU2 <- ReviewDatSAU3

#variable sp eez dependency
ReviewDatSAU2$spcatchdep <- ReviewDatSAU2$tonnescatchSP/ReviewDatSAU2$tonnescatchEEZ
ReviewDatSAU2$spvalchdep <- ReviewDatSAU2$landedvaluecatchSP/ReviewDatSAU2$landedvaluecatchEEZ


###GRAPHS EEZ dependency
#Subsets of the impacts
ReviewDatSAU2$b_impact<-as.factor(ReviewDatSAU2$b_impact)
ReviewDatSAU2$b_value<-as.numeric(as.character(ReviewDatSAU2$b_value))

#levels(ReviewDatSAU$b_impact)
levels(ReviewDatSAU2$b_impact)<-c("mean lat shift", "mean lat shift", "depth shift", "boundary lat shift", "boundary lat shift", "mean long shift", "mean long shift", "mean lat and long shift", "area occupied")

latitude<-subset (ReviewDatSAU2, b_impact =="mean lat shift")
depth<-subset (ReviewDatSAU2, b_impact=="depth shift")
range<-subset (ReviewDatSAU2, b_impact== "boundary lat shift")
area<-subset (ReviewDatSAU2, b_impact == "area occupied")

#####TOTAL EEZ catch:

###1. PLOTS OF IMPACTS AND EEZ CATCH 

##latitude impacts

l <- ggplot(latitude, aes(tonnescatchEEZ, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=tonnescatchEEZ),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(latitude, tonnescatchEEZ>1500000), size=3, vjust=1)+
  ggtitle("Latitude Shift")+
  xlab("EEZ total catch")+
  ylab("km/decade")
l 

##depth impacts

d <- ggplot(depth, aes(tonnescatchEEZ, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=tonnescatchEEZ),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(depth, tonnescatchEEZ>1500000), size=3, vjust=0.5)+
  ggtitle("depth Shift")+
  xlab("EEZ total catch")+
  ylab("m/decade")+
  ylim( -20, 20)
d 

##range impacts

r <- ggplot(range, aes(tonnescatchEEZ, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=tonnescatchEEZ),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(range, tonnescatchEEZ>1000000), size=3, vjust=0.5)+
  ggtitle("Range Shift")+
  xlab("EEZ total catch")+
  ylab("km/decade?")
r 

##area impacts

a <- ggplot(area, aes(tonnescatchEEZ, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=tonnescatchEEZ),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(area, tonnescatchEEZ>0.20), size=3, vjust=0.5)+
  ggtitle("Area Shift")+
  xlab("EEZ total catch")+
  ylab("m/decade?")
a 

```
5. EEZ total landed value

```{r,include=T, echo=F,  message=FALSE}

###2. PLOTS OF IMPACTS AND EEZ VALUE 

##latitude impacts

l <- ggplot(latitude, aes(landedvaluecatchEEZ, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=landedvaluecatchEEZ),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(latitude, landedvaluecatchEEZ>5000000), size=3, vjust=1)+
  ggtitle("Latitude Shift")+
  xlab("EEZ total value landed")+
  ylab("km/decade")
l 

##depth impacts

d <- ggplot(depth, aes(landedvaluecatchEEZ, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=landedvaluecatchEEZ),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(depth, landedvaluecatchEEZ>200000000), size=3, vjust=0.5)+
  ggtitle("depth Shift")+
  xlab("EEZ total value landed")+
  ylab("m/decade")+
  ylim( -20, 20)
d 

##range impacts

r <- ggplot(range, aes(landedvaluecatchEEZ, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=landedvaluecatchEEZ),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(range, landedvaluecatchEEZ>1000000), size=3, vjust=0.5)+
  ggtitle("Range Shift")+
  xlab("EEZ total value landed")+
  ylab("km/decade?")
r 

##area impacts

a <- ggplot(area, aes(landedvaluecatchEEZ, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=landedvaluecatchEEZ),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(area, landedvaluecatchEEZ>0.20), size=3, vjust=0.5)+
  ggtitle("Area Shift")+
  xlab("EEZ total value landed")+
  ylab("m/decade?")
a 

```
6. EEZ species total catch

```{r,include=T, echo=F,  message=FALSE}

#####SP EEZ catch:

###1. PLOTS OF IMPACTS AND SP CATCH IN EEZ



##latitude impacts

l <- ggplot(latitude, aes(tonnescatchSP, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=tonnescatchSP),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(latitude, tonnescatchSP>30000), size=3, vjust=1)+
  ggtitle("Latitude Shift")+
  xlab("EEZ sp catch")+
  ylab("km/decade")+
  ylim( -100, 100)
l 

##depth impacts

d <- ggplot(depth, aes(tonnescatchSP, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=tonnescatchSP),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(depth, tonnescatchSP>5000), size=3, vjust=0.5)+
  ggtitle("depth Shift")+
  xlab("EEZ sp catch")+
  ylab("m/decade") +
  ylim( -20, 20)
d 

##range impacts

r <- ggplot(range, aes(tonnescatchSP, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=tonnescatchSP),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(range, tonnescatchSP>1000), size=3, vjust=0.5)+
  ggtitle("Range Shift")+
  xlab("EEZ sp catch")+
  ylab("km/decade?")
r 

##area impacts

a <- ggplot(area, aes(tonnescatchSP, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=tonnescatchSP),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(area, tonnescatchSP>0.20), size=3, vjust=0.5)+
  ggtitle("Area Shift")+
  xlab("EEZ sp catch")+
  ylab("m/decade?")
a 

```
7. EEZ species total value

```{r,include=T, echo=F,  message=FALSE}

###2. PLOTS OF IMPACTS AND SP VALUE 

##latitude impacts

l <- ggplot(latitude, aes(landedvaluecatchSP, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=landedvaluecatchSP),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(latitude, landedvaluecatchSP>30000000), size=3, vjust=1)+
  ggtitle("Latitude Shift")+
  xlab("EEZ sp value landed")+
  ylab("km/decade")+
  ylim(-100,100)
l 

##depth impacts

d <- ggplot(depth, aes(landedvaluecatchSP, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=landedvaluecatchSP),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(depth, landedvaluecatchSP>50000000), size=3, vjust=0.5)+
  ggtitle("depth Shift")+
  xlab("EEZ sp value landed")+
  ylab("m/decade")+
  ylim( -20, 20)
d 

##range impacts

r <- ggplot(range, aes(landedvaluecatchSP, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=landedvaluecatchSP),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(range, landedvaluecatchSP>1000000), size=3, vjust=0.5)+
  ggtitle("Range Shift")+
  xlab("EEZ sp value landed")+
  ylab("km/decade?")
r 

##area impacts

a <- ggplot(area, aes(landedvaluecatchSP, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=landedvaluecatchSP),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(area, landedvaluecatchSP>0.20), size=3, vjust=0.5)+
  ggtitle("Area Shift")+
  xlab("EEZ sp value landed")+
  ylab("m/decade?")
a 

```
8. EEZ species catch dependence

```{r,include=T, echo=F,  message=FALSE}

##4. PLOTS OF IMPACTS AND EEZ SP CATCH DEPENDENCE

##latitude impacts

l <- ggplot(latitude, aes(spcatchdep, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=spcatchdep),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(latitude, spcatchdep>0.010), size=3, vjust=1)+
  ggtitle("Latitude Shift")+
  xlab("eez sp catch dependence (%)")+
  ylab("km/decade")+
  ylim(-100, 100)
l 

##depth impacts

d <- ggplot(depth, aes(spcatchdep, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=spcatchdep),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(depth, spcatchdep>0.0015), size=3, vjust=0.5)+
  ggtitle("depth Shift")+
  xlab("eez sp catch dependence (%)")+
  ylab("m/decade?")
d 

##range impacts

r <- ggplot(range, aes(spcatchdep, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=spcatchdep),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(range, spcatchdep>0.01), size=3, vjust=0.5)+
  ggtitle("Range Shift")+
  xlab("eez sp catch dependence (%)")+
  ylab("km/decade?")+
  xlim(0,0.2)
r 

##area impacts

a <- ggplot(area, aes(spcatchdep, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=spcatchdep),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(area, spcatchdep>0.0020), size=3, vjust=0.5)+
  ggtitle("Area Shift")+
  xlab("eez sp catch dependence (%)")+
  ylab("m/decade?")
a 


```
9. EEZ  species landed value dependence

```{r,include=T, echo=F,  message=FALSE}

##4. PLOTS OF IMPACTS AND EEZ SP LANDED VALUE DEPENDENCE

##latitude impacts

l <- ggplot(latitude, aes(spvalchdep, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=spvalchdep),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(latitude, spvalchdep>0.010), size=3, vjust=1)+
  ggtitle("Latitude Shift")+
  xlab("eez sp value dependence (%)")+
  ylab("km/decade")+
  ylim(-100, 100)
l 

##depth impacts

d <- ggplot(depth, aes(spvalchdep, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=spvalchdep),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(depth, spvalchdep>0.0015), size=3, vjust=0.5)+
  ggtitle("depth Shift")+
  xlab("eez sp landed value dependence (%)")+
  ylab("m/decade?")+
  ylim(-40, 40)
d 

##range impacts

r <- ggplot(range, aes(spvalchdep, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=spvalchdep),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(range, spvalchdep>0.001), size=3, vjust=0.5)+
  ggtitle("Range Shift")+
  xlab("eez sp value dependence (%)")+
  ylab("km/decade?")
  #xlim(0,0.2)
r 

##area impacts

a <- ggplot(area, aes(spvalchdep, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(size=spvalchdep),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(area, spvalchdep>0.00020), size=3, vjust=0.5)+
  ggtitle("Area Shift")+
  xlab("eez sp value dependence (%)")+
  ylab("m/decade?")
a 

```
10. Multi Variables Graphs
```{r,include=T, echo=F,  message=FALSE}

##EEZ catches sp


l <- ggplot(latitude, aes(tonnescatchSP, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(color=spcatchdep, size=landedvaluecatchSP),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(latitude, tonnescatchSP>1000), size=3, vjust=1)+
  ggtitle("Latitude Shift")+
  xlab("eez sp catch")+
  ylab("km/decade")+
  ylim(-100, 100)
l 

##EEZ catches sp

#eez countries
l <- ggplot(latitude, aes(tonnescatchSP, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(color=landedvaluecatchSP, size=spcatchdep),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(latitude, tonnescatchSP>30000), size=3, vjust=1)+
  ggtitle("Latitude Shift")+
  xlab("eez sp catch")+
  ylab("km/decade")+
  ylim(-60, 60)
l 



l <- ggplot(depth, aes(tonnescatchSP, b_value, label = area_name)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(color=landedvaluecatchSP, size=spcatchdep),position = position_jitter(width = .001))+
  geom_text_repel(data=subset(latitude, tonnescatchSP>500), size=3, vjust=1)+
  ggtitle("Depth Shift")+
  xlab("eez sp catch")+
  ylab("m/decade") +
  ylim(-20, 20)
l 

#eez species
l <- ggplot(latitude, aes(tonnescatchSP, b_value, label = b_scientific_name.y)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(color=landedvaluecatchSP, size=spcatchdep),position = position_jitter(width = .01))+
  geom_text_repel(data=subset(latitude, tonnescatchSP>1000), size=3, vjust=1)+
  ggtitle("Latitude Shift")+
  xlab("eez sp catch")+
  ylab("km/decade")+
  ylim(-50, 50)
l 



l <- ggplot(depth, aes(tonnescatchSP, b_value, label = b_scientific_name.y)) +
  #geom_point()
  geom_jitter(alpha=0.1, aes(color=landedvaluecatchSP, size=spcatchdep),position = position_jitter(width = .001))+
  geom_text_repel(data=subset(latitude, tonnescatchSP>1000), size=3, vjust=1)+
  ggtitle("Depth Shift")+
  xlab("eez sp catch")+
  ylab("m/decade") +
  ylim(-20, 20)
l 